{% extends 'base.html' %}
{% load static %}

{% block content %}

<!-- Menu de busqueda y muestra de resultados a través de gráficos -->
<div class="d-flex flex-column align-items-center">

  <!-- Logo -->
  <div class="d-flex justify-content-center rounded shadow bg-transparent mb-4">
    <img src="{% static 'img/nombre_logo.png' %}" alt="Logo" class="img-fluid" style="max-width: 400px; max-height: auto;">
  </div>

  <!-- Formulario -->
  <form method="post" class="w-100" style="max-width: 600px; padding: 1.5rem; border-radius: 1rem; box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,.075);">
    {% csrf_token %}
    
    <!-- Inputs en una fila -->
    <div class="d-flex mb-3">
      <!-- Input dominio/IP -->
      <input 
          type="text" 
          name="target" 
          placeholder="Dominio o IP" 
          class="form-control me-2"
          required
      >

      <!-- Dropdown módulos -->
      <div class="dropdown">
        <button 
          type="button" 
          id="dropdownButton"
          class="btn btn-light dropdown-toggle"
          data-bs-toggle="dropdown" aria-expanded="false"
        >
          Seleccionar módulos
        </button>

        <!-- Menú desplegable -->
        <div 
          id="dropdownMenu" 
          class="dropdown-menu p-3 shadow" 
          style="min-width: 220px;"
        >
          <label class="form-check mb-2 d-flex align-items-center">
            <input type="checkbox" class="form-check-input me-2" name="modules" value="dns">
            <span>DNS</span>
            <span class="badge bg-info text-dark ms-2" style="cursor: help;" title="Herramienta para consultas DNS de IPs y dominios">i</span>
          </label>

          <label class="form-check mb-2 d-flex align-items-center">
            <input type="checkbox" class="form-check-input me-2" name="modules" value="dorks">
            <span>Dorks</span>
            <span class="badge bg-info text-dark ms-2" style="cursor: help;" title="Búsquedas avanzadas en Google">i</span>
          </label>

          <label class="form-check mb-2 d-flex align-items-center">
            <input type="checkbox" class="form-check-input me-2" name="modules" value="headerhttp">
            <span>Headers HTTP</span>
            <span class="badge bg-info text-dark ms-2" style="cursor: help;" title="Herramienta para analizar los headers HTTP de un sitio web">i</span>
          </label>

          <label class="form-check mb-2 d-flex align-items-center">
            <input type="checkbox" class="form-check-input me-2" name="modules" value="nmap">
            <span>Nmap</span>
            <span class="badge bg-info text-dark ms-2" style="cursor: help;" title="Escáner de red para descubrir hosts y servicios">i</span>
          </label>

          <label class="form-check mb-2 d-flex align-items-center">
            <input type="checkbox" class="form-check-input me-2" name="modules" value="ssl">
            <span>SSL</span>
            <span class="badge bg-info text-dark ms-2" style="cursor: help;" title="Herramienta para analizar la seguridad SSL de un sitio web">i</span>
          </label>

          <label class="form-check mb-2 d-flex align-items-center">
            <input type="checkbox" class="form-check-input me-2" name="modules" value="whois">
            <span>Whois</span>
            <span class="badge bg-info text-dark ms-2" style="cursor: help;" title="Herramienta para consultar información WHOIS de dominios">i</span>
          </label>
        </div>
      </div>
    </div>

    <!-- Botón Escanear -->
    <div class="text-center">
      <button 
          type="submit" 
          class="btn btn-primary btn-lg"
      >
          Escanear 🚀
      </button>
    </div>

    <!--Errores de formulario-->
    {% if form.errors %}
        <div class="alert alert-danger mt-3">
            <ul class="mb-0">
                {% for field in form %}
                    {% for error in field.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                {% endfor %}
                {% for error in form.non_field_errors %}
                    <li>{{ error }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}
  </form>

</div>

<!--AQUI VAN LOS RESULTADOS DE LOS MODULOS COMO GRAFICOS U OTROS (quizas en otros archivos)-->
{% include 'scan_base_layout.html' %}


{% endblock %}

{% block extra_js %}
{{ block.super }}
<script src="{% static 'js/modulosDesplegables.js' %}"></script>
<script>
  // Inicializar tooltips de Bootstrap
  var tooltipTriggerList = [].slice.call(document.querySelectorAll('[title]'))
  var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
    return new bootstrap.Tooltip(tooltipTriggerEl)
  })
</script>
{% endblock %}

{% extends 'base.html' %}
{% load static %}

{% block title %}Autenticación{% endblock %}

{% block content %}

<div class="container-fluid">
  <div class="row">
    
    <!-- Columna izquierda (puedes dejarla vacía o poner una imagen/texto) -->
    <div class="col d-none d-md-block">
      <!-- Aquí podría ir un logo o imagen -->
    </div>

    <!-- Columna derecha con el formulario -->
    <div class="col-md-6 d-flex justify-content-center align-items-start pt-5">
      <div class="bg-white p-4 p-md-5 rounded shadow w-100" style="max-width: 28rem;">

        <!-- Selector de formulario -->
        <ul class="nav nav-tabs mb-4" role="tablist">
          <li class="nav-item flex-fill" role="presentation">
            <button class="nav-link active text-primary fw-medium" id="login-tab" data-bs-toggle="tab" data-bs-target="#login-form" type="button" role="tab">Iniciar Sesión</button>
          </li>
          <li class="nav-item flex-fill" role="presentation">
            <button class="nav-link text-secondary fw-medium" id="register-tab" data-bs-toggle="tab" data-bs-target="#register-form" type="button" role="tab">Registrarse</button>
          </li>
        </ul>

        <!-- Formularios -->
        <div class="tab-content">

          <!-- Login -->
          <form id="login-form" method="POST" action="{% url 'login_view' %}" class="tab-pane fade show active">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.GET.next }}">

            <div class="mb-3">
              <label for="id_username" class="form-label">Usuario</label>
              <input type="text" id="id_username" name="username" required class="form-control">
            </div>

            <div class="mb-3">
              <label for="id_password" class="form-label">Contraseña</label>
              <input type="password" id="id_password" name="password" required class="form-control">
            </div>

            <div class="d-flex justify-content-between align-items-center mb-3">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="remember-me" name="remember-me">
                <label class="form-check-label" for="remember-me">Recordarme</label>
              </div>
              <div>
                <a href="{% url 'password_reset' %}" class="link-primary">¿Olvidaste tu contraseña?</a>
              </div>
            </div>

            <button type="submit" class="btn btn-primary w-100 mb-2">Iniciar Sesión</button>
          </form>

          <!-- Registro -->
          <form id="register-form" method="POST" action="{% url 'register_view' %}" class="tab-pane fade">
            {% csrf_token %}

            <div class="mb-3">
              <label for="register-username" class="form-label">Usuario</label>
              <input type="text" id="register-username" name="username" required class="form-control">
            </div>
            <div class="mb-3">
              <label for="register-email" class="form-label">Email</label>
              <input type="email" id="register-email" name="email" required class="form-control">
            </div>
            <div class="mb-3">
              <label for="register-password1" class="form-label">Contraseña</label>
              <input type="password" id="register-password1" name="password1" required class="form-control">
            </div>
            <div class="mb-3">
              <label for="register-password2" class="form-label">Confirmar Contraseña</label>
              <input type="password" id="register-password2" name="password2" required class="form-control">
            </div>

            <button type="submit" class="btn btn-success w-100">Registrarse</button>
          </form>

        </div>

        <!--Errores de formulario-->
        {% if form.errors %}
        <div class="alert alert-danger mt-3">
          <ul class="mb-0">
            {% for field in form %}
              {% for error in field.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}

      </div>
    </div>

  </div>
</div>

{% endblock %}

{% block extra_js %}
{{ block.super }}
<script src="{% static 'js/authForms.js' %}"></script>
{% endblock %}
